<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>YouTube Downloader - ดาวน์โหลดวิดีโอ YouTube ฟรี | MP4, MP3 คุณภาพสูง</title>
    <meta name="description" content="ดาวน์โหลดวิดีโอ YouTube เป็น MP4 และแยกเสียง MP3 ฟรี คุณภาพสูงถึง 4K ใช้งานง่าย รวดเร็ว ปลอดภัย รองรับทุกอุปกรณ์">
    <meta name="keywords" content="YouTube downloader, ดาวน์โหลด YouTube, YouTube to MP4, YouTube to MP3, แปลงวิดีโอ, ดาวน์โหลดฟรี, video downloader">
    <meta name="author" content="YouTube Downloader">
    <meta name="robots" content="index, follow">
    <meta name="language" content="th">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="YouTube Downloader - ดาวน์โหลดวิดีโอ YouTube ฟรี">
    <meta property="og:description" content="ดาวน์โหลดวิดีโอ YouTube เป็น MP4 และแยกเสียง MP3 ฟรี คุณภาพสูงถึง 4K">
    <meta property="og:type" content="website">
    <meta property="og:image" content="/favicon-192x192.png">
    <meta property="og:url" content="https://youtube-downloader.onrender.com">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="YouTube Downloader - ดาวน์โหลดวิดีโอ YouTube ฟรี">
    <meta name="twitter:description" content="ดาวน์โหลดวิดีโอ YouTube เป็น MP4 และแยกเสียง MP3 ฟรี คุณภาพสูงถึง 4K">
    <meta name="twitter:image" content="/favicon-192x192.png">
    
    <!-- Favicon with cache busting -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico?v=2025">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=2025">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=2025">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=2025">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png?v=2025">
    <link rel="manifest" href="/site.webmanifest?v=2025">
    
    <!-- Theme Color for Mobile Browsers -->
    <meta name="theme-color" content="#667eea">
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="YT Downloader">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://youtube-downloader.onrender.com">
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1797172064583364"
         crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .logo {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .logo-icon {
            background: linear-gradient(45deg, #FF0000, #FF6B6B);
            color: white;
            padding: 15px;
            border-radius: 20px;
            font-size: 2.5rem;
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.3);
            animation: logoGlow 2s ease-in-out infinite alternate;
        }

        @keyframes logoGlow {
            from {
                box-shadow: 0 10px 30px rgba(255, 0, 0, 0.3);
            }
            to {
                box-shadow: 0 15px 40px rgba(255, 0, 0, 0.5);
            }
        }

        .logo-text {
            background: linear-gradient(45deg, #ffffff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            margin-bottom: 40px;
        }

        .download-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .ad-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .ad-placeholder {
            background: #f0f0f0;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            color: #666;
            min-height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .ad-placeholder i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .input-group {
            position: relative;
            margin-bottom: 20px;
        }

        .input-group i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            z-index: 1;
        }

        input[type="text"], input[type="url"] {
            width: 100%;
            padding: 15px 50px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        input[type="text"]:focus, input[type="url"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            background: white;
        }

        .download-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .download-btn:active {
            transform: translateY(0);
        }

        .download-btn i {
            margin-right: 10px;
        }

        .results-section {
            margin-top: 30px;
            display: none;
        }

        .video-info {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .video-thumbnail {
            width: 150px;
            height: 84px;
            border-radius: 8px;
            object-fit: cover;
        }

        .video-details h3 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .video-details p {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 4px;
        }

        .format-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .format-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .format-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .format-card i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #667eea;
        }

        .format-card h4 {
            margin-bottom: 8px;
            color: #333;
        }

        .format-card p {
            color: #666;
            font-size: 0.9rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer-ads {
            margin-top: 40px;
            text-align: center;
        }

        .footer-ads .ad-placeholder {
            min-height: 90px;
        }

        .features {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
        }

        .features h2 {
            text-align: center;
            margin-bottom: 25px;
            color: #333;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-item {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            background: #f8f9fa;
        }

        .feature-item i {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 15px;
        }

        .feature-item h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .feature-item p {
            color: #666;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .video-info {
                flex-direction: column;
                text-align: center;
            }
            
            .format-options {
                grid-template-columns: 1fr;
            }
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #856404;
        }

        .warning i {
            margin-right: 8px;
            color: #f39c12;
        }

        /* Footer Styles */
        .footer {
            background: #2c3e50;
            color: white;
            padding: 40px 0 20px;
            margin-top: 50px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .footer-section h3 {
            margin-bottom: 15px;
            color: #3498db;
        }

        .footer-section h4 {
            margin-bottom: 10px;
            color: #ecf0f1;
            font-size: 1.1rem;
        }

        .footer-section p {
            line-height: 1.6;
            margin-bottom: 10px;
            color: #bdc3c7;
        }

        .footer-section ul {
            list-style: none;
            padding: 0;
        }

        .footer-section ul li {
            margin-bottom: 8px;
        }

        .footer-section ul li a {
            color: #bdc3c7;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section ul li a:hover {
            color: #3498db;
        }

        .footer-bottom {
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid #34495e;
            margin-top: 30px;
            color: #95a5a6;
        }

        .footer-bottom a {
            color: #3498db;
            text-decoration: none;
        }

        .footer-bottom a:hover {
            text-decoration: underline;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f1f2f6;
        }

        .modal-header h2 {
            color: #2c3e50;
            margin: 0;
        }

        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #e74c3c;
        }

        .modal-body {
            line-height: 1.6;
            color: #34495e;
        }

        .modal-body h3 {
            color: #2c3e50;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .modal-body h4 {
            color: #34495e;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .modal-body ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .modal-body ul li {
            margin-bottom: 8px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(-50px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fab fa-youtube"></i>
                </div>
                <div class="logo-text">
                    YouTube Downloader
                </div>
            </div>
            <p class="subtitle">ดาวน์โหลดวิดีโอ MP4 และเสียง MP3 จาก YouTube ฟรี คุณภาพสูงถึง 4K</p>
        </header>

        <div class="features">
            <h2>ฟีเจอร์เด่น</h2>
            <div class="feature-grid">
                <div class="feature-item">
                    <i class="fas fa-download"></i>
                    <h3>ดาวน์โหลดฟรี</h3>
                    <p>ดาวน์โหลดวิดีโอและเสียงจาก YouTube ได้ฟรี ไม่จำกัดจำนวนครั้ง</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-hd-video"></i>
                    <h3>คุณภาพสูง</h3>
                    <p>รองรับการดาวน์โหลดในหลายความละเอียด จาก 360p ถึง 4K</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-music"></i>
                    <h3>แยกเสียง MP3</h3>
                    <p>แยกเสียงจากวิดีโอเป็นไฟล์ MP3 คุณภาพสูง</p>
                </div>
                <div class="feature-item">
                    <i class="fas fa-mobile-alt"></i>
                    <h3>ใช้งานง่าย</h3>
                    <p>ออกแบบให้ใช้งานง่าย รองรับทุกอุปกรณ์ ทั้งมือถือและคอมพิวเตอร์</p>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="download-section">
                <div class="warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>หมายเหตุ:</strong> โปรดใช้เครื่องมือนี้เพื่อดาวน์โหลดเนื้อหาที่คุณมีสิทธิ์เท่านั้น และปฏิบัติตามข้อกำหนดการใช้งานของ YouTube
                </div>

                <div class="input-section">
                    <div class="input-group">
                        <i class="fas fa-link"></i>
                        <input type="url" id="videoUrl" placeholder="วาง URL ของวิดีโอ YouTube ที่นี่...">
                    </div>
                    <button class="download-btn" onclick="processVideo()">
                        <i class="fas fa-info-circle"></i>
                        ดึงข้อมูลวิดีโอ
                    </button>
                </div>

                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>กำลังประมวลผล...</p>
                </div>

                <div class="results-section" id="results">
                    <div class="video-info" id="videoInfo">
                        <img src="" alt="" class="video-thumbnail" id="videoThumbnail">
                        <div class="video-details">
                            <h3 id="videoTitle"></h3>
                            <p id="videoChannel"></p>
                            <p id="videoDuration"></p>
                            <p id="videoViews"></p>
                        </div>
                    </div>

                    <div class="format-options" id="formatOptions">
                        <!-- รูปแบบการดาวน์โหลดจะถูกแสดงที่นี่ -->
                    </div>
                </div>
            </div>

            <div class="ad-section">
                <div class="ad-placeholder">
                    <i class="fas fa-ad"></i>
                    <p><strong>Google AdSense</strong><br>โฆษณาแบนเนอร์ 300x250</p>
                    <!-- ใส่โค้ด Google AdSense ตรงนี้ -->
                </div>
                <div class="ad-placeholder">
                    <i class="fas fa-ad"></i>
                    <p><strong>Google AdSense</strong><br>โฆษณาแบนเนอร์ 300x600</p>
                    <!-- ใส่โค้ด Google AdSense ตรงนี้ -->
                </div>
            </div>
        </div>

        <div class="footer-ads">
            <div class="ad-placeholder">
                <i class="fas fa-ad"></i>
                <p><strong>Google AdSense</strong> - โฆษณาแบนเนอร์ 728x90</p>
                <!-- Auto ads จะแสดงที่นี่ -->
                <ins class="adsbygoogle"
                     style="display:block"
                     data-ad-client="ca-pub-1797172064583364"
                     data-ad-slot="auto"
                     data-ad-format="auto"
                     data-full-width-responsive="true"></ins>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>YouTube Downloader</h3>
                <p>เครื่องมือดาวน์โหลดวิดีโอ YouTube ที่ปลอดภัย รวดเร็ว และใช้งานง่าย รองรับการดาวน์โหลดในคุณภาพสูงถึง 4K</p>
                <p>✅ ใช้งานฟรี 100%<br>
                   ✅ ไม่ต้องสมัครสมาชิก<br>
                   ✅ รองรับทุกอุปกรณ์</p>
            </div>
            
            <div class="footer-section">
                <h4>ฟีเจอร์</h4>
                <ul>
                    <li><a href="#">ดาวน์โหลด MP4</a></li>
                    <li><a href="#">แยกเสียง MP3</a></li>
                    <li><a href="#">คุณภาพสูง 4K</a></li>
                    <li><a href="#">ใช้งานง่าย</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>นโยบาย</h4>
                <ul>
                    <li><a href="#" onclick="openModal('privacy')">นโยบายความเป็นส่วนตัว</a></li>
                    <li><a href="#" onclick="openModal('terms')">ข้อกำหนดการใช้งาน</a></li>
                    <li><a href="#" onclick="openModal('disclaimer')">ข้อจำกัดความรับผิดชอบ</a></li>
                    <li><a href="#" onclick="openModal('contact')">ติดต่อเรา</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>ข้อมูลเพิ่มเติม</h4>
                <ul>
                    <li><a href="#" onclick="openModal('help')">วิธีใช้งาน</a></li>
                    <li><a href="#" onclick="openModal('faq')">คำถามที่พบบ่อย</a></li>
                    <li><a href="#" onclick="openModal('supported')">รูปแบบที่รองรับ</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>&copy; 2025 YouTube Downloader. สงวนลิขสิทธิ์ | 
            <a href="#" onclick="openModal('privacy')">นโยบายความเป็นส่วนตัว</a> | 
            <a href="#" onclick="openModal('terms')">ข้อกำหนดการใช้งาน</a></p>
            <p>⚠️ โปรดใช้เครื่องมือนี้เพื่อดาวน์โหลดเนื้อหาที่คุณมีสิทธิ์เท่านั้น</p>
        </div>
    </footer>

    <!-- Modals -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>นโยบายความเป็นส่วนตัว</h2>
                <span class="close" onclick="closeModal('privacy')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>การเก็บรวบรวมข้อมูล</h3>
                <p>เว็บไซต์ของเราไม่เก็บข้อมูลส่วนบุคคลของผู้ใช้ เช่น ชื่อ อีเมล หรือข้อมูลการติดต่อ</p>
                
                <h3>ข้อมูลที่เก็บรวบรวมอัตโนมัติ</h3>
                <ul>
                    <li>IP Address (สำหรับสถิติการใช้งาน)</li>
                    <li>User Agent (ประเภทเบราว์เซอร์)</li>
                    <li>Cookies (สำหรับการทำงานของเว็บไซต์)</li>
                </ul>
                
                <h3>Google AdSense</h3>
                <p>เว็บไซต์ใช้ Google AdSense เพื่อแสดงโฆษณา Google อาจใช้ cookies เพื่อแสดงโฆษณาที่เกี่ยวข้อง</p>
                
                <h3>การใช้งาน URL</h3>
                <p>URL ที่คุณป้อนจะถูกส่งไปยังเซิร์ฟเวอร์เพื่อดำเนินการดาวน์โหลด แต่จะไม่ถูกเก็บไว้ในระบบ</p>
                
                <h4>ติดต่อเรา</h4>
                <p>หากมีคำถามเกี่ยวกับนโยบายความเป็นส่วนตัว กรุณาติดต่อผ่านช่องทางที่ระบุไว้</p>
            </div>
        </div>
    </div>

    <div id="termsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ข้อกำหนดการใช้งาน</h2>
                <span class="close" onclick="closeModal('terms')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>การใช้งานที่ยอมรับได้</h3>
                <ul>
                    <li>ใช้เพื่อดาวน์โหลดเนื้อหาที่คุณมีสิทธิ์เท่านั้น</li>
                    <li>ใช้เพื่อการศึกษาและใช้งานส่วนตัว</li>
                    <li>เคารพลิขสิทธิ์ของเจ้าของเนื้อหา</li>
                </ul>
                
                <h3>การใช้งานที่ห้าม</h3>
                <ul>
                    <li>ดาวน์โหลดเนื้อหาที่มีลิขสิทธิ์โดยไม่ได้รับอนุญาต</li>
                    <li>ใช้เพื่อการค้าหรือแจกจ่ายโดยไม่ได้รับอนุญาต</li>
                    <li>ใช้ในทางที่ผิดกฎหมาย</li>
                </ul>
                
                <h3>ข้อจำกัดความรับผิดชอบ</h3>
                <p>เราไม่รับผิดชอบต่อการใช้งานที่ไม่เหมาะสมหรือผิดกฎหมาย ผู้ใช้ต้องรับผิดชอบการใช้งานของตนเอง</p>
            </div>
        </div>
    </div>

    <div id="disclaimerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ข้อจำกัดความรับผิดชอบ</h2>
                <span class="close" onclick="closeModal('disclaimer')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>การใช้งานเครื่องมือ</h3>
                <p>เครื่องมือนี้พัฒนาขึ้นเพื่อให้ผู้ใช้สามารถดาวน์โหลดเนื้อหาที่ตนเองมีสิทธิ์ได้สะดวกขึ้น</p>
                
                <h3>ความรับผิดชอบของผู้ใช้</h3>
                <ul>
                    <li>ตรวจสอบสิทธิ์ในการดาวน์โหลดก่อนใช้งาน</li>
                    <li>เคารพลิขสิทธิ์และข้อกำหนดของ YouTube</li>
                    <li>ไม่นำเนื้อหาที่ดาวน์โหลดไปใช้ในทางการค้าโดยไม่ได้รับอนุญาต</li>
                </ul>
                
                <h3>ข้อสงวนสิทธิ์</h3>
                <p>เราขอสงวนสิทธิ์ในการเปลี่ยนแปลงหรือยกเลิกบริการโดยไม่ต้องแจ้งให้ทราบล่วงหน้า</p>
            </div>
        </div>
    </div>

    <div id="contactModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ติดต่อเรา</h2>
                <span class="close" onclick="closeModal('contact')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>ช่องทางการติดต่อ</h3>
                <p>หากคุณมีคำถาม ข้อเสนอแนะ หรือต้องการรายงานปัญหา สามารถติดต่อเราได้ผ่านช่องทางต่อไปนี้:</p>
                
                <h4>อีเมล</h4>
                <p>📧 support@youtube-downloader.com</p>
                
                <h4>เวลาทำการ</h4>
                <p>🕐 จันทร์ - ศุกร์ 9:00 - 18:00 น. (เวลาไทย)</p>
                
                <h4>การตอบกลับ</h4>
                <p>เราจะตอบกลับภายใน 24-48 ชั่วโมง</p>
            </div>
        </div>
    </div>

    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>วิธีใช้งาน</h2>
                <span class="close" onclick="closeModal('help')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>ขั้นตอนการใช้งาน</h3>
                <ol>
                    <li><strong>คัดลอก URL:</strong> ไปที่ YouTube และคัดลอก URL ของวิดีโอที่ต้องการ</li>
                    <li><strong>วาง URL:</strong> วาง URL ลงในช่องข้อความ (ระบบจะดึงข้อมูลอัตโนมัติ)</li>
                    <li><strong>เลือกรูปแบบ:</strong> เลือกรูปแบบและคุณภาพที่ต้องการ</li>
                    <li><strong>ดาวน์โหลด:</strong> คลิกปุ่มดาวน์โหลดและรอให้เสร็จสิ้น</li>
                </ol>
                
                <h3>เทคนิคการใช้งาน</h3>
                <ul>
                    <li>🚀 <strong>ดาวน์โหลดเร็ว:</strong> ใช้ปุ่ม "ดาวน์โหลดเร็ว" สำหรับ Direct Link</li>
                    <li>🔄 <strong>ดาวน์โหลดสำรอง:</strong> ใช้ปุ่มเซิร์ฟเวอร์หากการดาวน์โหลดเร็วไม่ทำงาน</li>
                    <li>📱 <strong>มือถือ:</strong> สามารถใช้งานได้บนมือถือและแท็บเล็ต</li>
                </ul>
            </div>
        </div>
    </div>

    <div id="faqModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>คำถามที่พบบ่อย</h2>
                <span class="close" onclick="closeModal('faq')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>❓ เว็บไซต์นี้ฟรีหรือไม่?</h3>
                <p>✅ ใช่ เว็บไซต์นี้ให้บริการฟรี 100% ไม่มีค่าใช้จ่ายซ่อนเร้น</p>
                
                <h3>❓ ต้องสมัครสมาชิกหรือไม่?</h3>
                <p>❌ ไม่ต้อง สามารถใช้งานได้ทันทีโดยไม่ต้องสมัครสมาชิก</p>
                
                <h3>❓ รองรับคุณภาพใดบ้าง?</h3>
                <p>📹 รองรับตั้งแต่ 360p ถึง 4K (8K ในบางกรณี) ขึ้นอยู่กับวิดีโอต้นฉบับ</p>
                
                <h3>❓ ดาวน์โหลดช้าทำอย่างไร?</h3>
                <p>🔄 ลองใช้ปุ่ม "ดาวน์โหลดเร็ว" หรือเปลี่ยนไปใช้ปุ่มเซิร์ฟเวอร์</p>
                
                <h3>❓ ปลอดภัยหรือไม่?</h3>
                <p>🔒 ปลอดภัย เราไม่เก็บข้อมูลส่วนตัวและไม่มีไวรัส</p>
            </div>
        </div>
    </div>

    <div id="supportedModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>รูปแบบที่รองรับ</h2>
                <span class="close" onclick="closeModal('supported')">&times;</span>
            </div>
            <div class="modal-body">
                <h3>🎥 รูปแบบวิดีโอ</h3>
                <ul>
                    <li><strong>MP4:</strong> รูปแบบยอดนิยม เล่นได้ทุกอุปกรณ์</li>
                    <li><strong>WEBM:</strong> คุณภาพสูง ขนาดไฟล์เล็ก</li>
                    <li><strong>3GP:</strong> สำหรับมือถือเก่า</li>
                </ul>
                
                <h3>🎵 รูปแบบเสียง</h3>
                <ul>
                    <li><strong>MP3:</strong> รูปแบบเสียงยอดนิยม</li>
                    <li><strong>M4A:</strong> คุณภาพเสียงสูง</li>
                    <li><strong>WEBM Audio:</strong> ขนาดเล็ก คุณภาพดี</li>
                </ul>
                
                <h3>📺 คุณภาพวิดีโอ</h3>
                <ul>
                    <li>144p, 240p, 360p (มือถือ)</li>
                    <li>480p, 720p (HD)</li>
                    <li>1080p (Full HD)</li>
                    <li>1440p, 2160p (4K)</li>
                    <li>4320p (8K) - หากมี</li>
                </ul>
                
                <h3>🔊 คุณภาพเสียง</h3>
                <ul>
                    <li>128kbps (คุณภาพมาตรฐาน)</li>
                    <li>192kbps (คุณภาพดี)</li>
                    <li>320kbps (คุณภาพสูงพิเศษ)</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // ตัวแปรเก็บข้อมูลวิดีโอปัจจุบัน
        let currentVideoData = null;

        // ฟังก์ชันสำหรับประมวลผลวิดีโอ
        async function processVideo() {
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            const button = event.target;
            const originalButtonText = button.innerHTML;
            
            const query = document.getElementById('videoUrl').value.trim();
            if (!query) {
                showToast('กรุณาใส่ URL ของวิดีโอ YouTube', 'error');
                return;
            }
            
            if (!isValidYouTubeUrl(query)) {
                showToast('กรุณาใส่ URL ของ YouTube ที่ถูกต้อง', 'error');
                return;
            }

            // แสดง loading
            setButtonLoading(button, true);
            loading.style.display = 'block';
            results.style.display = 'none';

            try {
                showToast('กำลังดึงข้อมูลวิดีโอ...', 'info');
                
                // เรียก API เพื่อดึงข้อมูลวิดีโอ
                const response = await fetch('/api/video-info', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ url: query })
                });

                const data = await response.json();

                if (!response.ok) {
                    let errorMessage = 'เกิดข้อผิดพลาดในการดึงข้อมูลวิดีโอ';
                    
                    if (response.status === 400) {
                        errorMessage = data.error || 'URL ไม่ถูกต้องหรือวิดีโอไม่พร้อมใช้งาน';
                    } else if (response.status === 429) {
                        errorMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่';
                    } else if (response.status >= 500) {
                        errorMessage = 'เซิร์ฟเวอร์ขัดข้อง กรุณาลองใหม่ในภายหลัง';
                    }
                    
                    throw new Error(errorMessage);
                }

                if (data.success) {
                    currentVideoData = data;
                    displayVideoInfo(data.video);
                    displayFormatOptions(data.formats);
                    results.style.display = 'block';
                    showToast('ดึงข้อมูลวิดีโอสำเร็จ!', 'success');
                } else {
                    throw new Error('ไม่สามารถดึงข้อมูลวิดีโอได้');
                }
            } catch (error) {
                console.error('Error:', error);
                
                let errorMessage = 'เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง';
                
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    errorMessage = 'ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ กรุณาตรวจสอบการเชื่อมต่ออินเทอร์เน็ต';
                } else if (error.message.includes('429')) {
                    errorMessage = 'คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่';
                } else if (error.message.includes('timeout')) {
                    errorMessage = 'คำขอใช้เวลานานเกินไป กรุณาลองใหม่อีกครั้ง';
                } else if (error.message) {
                    errorMessage = error.message;
                }
                
                showToast(errorMessage, 'error');
            } finally {
                loading.style.display = 'none';
                setButtonLoading(button, false, originalButtonText);
            }
        }

        // ฟังก์ชันแสดงข้อมูลวิดีโอ
        function displayVideoInfo(info) {
            document.getElementById('videoTitle').textContent = info.title;
            document.getElementById('videoChannel').textContent = info.author || info.channel;
            document.getElementById('videoDuration').textContent = 'ระยะเวลา: ' + info.duration;
            document.getElementById('videoViews').textContent = 'ยอดชม: ' + info.views;
            document.getElementById('videoThumbnail').src = info.thumbnail;
            document.getElementById('videoThumbnail').alt = info.title;
        }

        // ฟังก์ชันแสดงตัวเลือกรูปแบบ
        function displayFormatOptions(formats) {
            const formatOptions = document.getElementById('formatOptions');
            formatOptions.innerHTML = '';

            // แสดงรูปแบบวิดีโอ
            if (formats.video && formats.video.length > 0) {
                formats.video.forEach((format, index) => {
                    if (index < 3) { // จำกัดแค่ 3 รูปแบบแรก
                        const card = document.createElement('div');
                        card.className = 'format-card';
                        card.innerHTML = `
                            <i class="fas fa-video"></i>
                            <h4>MP4 - ${format.quality}</h4>
                            <p>วิดีโอ ${format.container.toUpperCase()}</p>
                            <div class="download-buttons">
                                <button class="download-btn-primary" onclick="downloadVideo('video', ${format.itag}, '${format.quality}')">
                                    <i class="fas fa-download"></i> ดาวน์โหลดเร็ว
                                </button>
                                <button class="download-btn-secondary" onclick="downloadVideoFallback('video', ${format.itag}, '${format.quality}')" title="ดาวน์โหลดผ่านเซิร์ฟเวอร์">
                                    <i class="fas fa-server"></i>
                                </button>
                            </div>
                        `;
                        formatOptions.appendChild(card);
                    }
                });
            }

            // แสดงรูปแบบเสียง
            if (formats.audio && formats.audio.length > 0) {
                formats.audio.forEach((format, index) => {
                    if (index < 3) { // จำกัดแค่ 3 รูปแบบแรก
                        const card = document.createElement('div');
                        card.className = 'format-card';
                        card.innerHTML = `
                            <i class="fas fa-music"></i>
                            <h4>MP3 - ${format.quality}</h4>
                            <p>เสียงเท่านั้น</p>
                            <div class="download-buttons">
                                <button class="download-btn-primary" onclick="downloadVideo('audio', ${format.itag}, '${format.quality}')">
                                    <i class="fas fa-download"></i> ดาวน์โหลดเร็ว
                                </button>
                                <button class="download-btn-secondary" onclick="downloadVideoFallback('audio', ${format.itag}, '${format.quality}')" title="ดาวน์โหลดผ่านเซิร์ฟเวอร์">
                                    <i class="fas fa-server"></i>
                                </button>
                            </div>
                        `;
                        formatOptions.appendChild(card);
                    }
                });
            }

            // เพิ่มตัวเลือกเริ่มต้นหากไม่มีรูปแบบเฉพาะ
            if ((!formats.video || formats.video.length === 0) && (!formats.audio || formats.audio.length === 0)) {
                formatOptions.innerHTML = `
                    <div class="format-card">
                        <i class="fas fa-video"></i>
                        <h4>MP4 - คุณภาพสูงสุด</h4>
                        <p>วิดีโอคุณภาพดีที่สุด</p>
                        <div class="download-buttons">
                            <button class="download-btn-primary" onclick="downloadVideo('video', null, 'highest')">
                                <i class="fas fa-download"></i> ดาวน์โหลดเร็ว
                            </button>
                            <button class="download-btn-secondary" onclick="downloadVideoFallback('video', null, 'highest')" title="ดาวน์โหลดผ่านเซิร์ฟเวอร์">
                                <i class="fas fa-server"></i>
                            </button>
                        </div>
                    </div>
                    <div class="format-card">
                        <i class="fas fa-music"></i>
                        <h4>MP3 - คุณภาพสูงสุด</h4>
                        <p>เสียงคุณภาพดีที่สุด</p>
                        <div class="download-buttons">
                            <button class="download-btn-primary" onclick="downloadVideo('audio', null, 'highestaudio')">
                                <i class="fas fa-download"></i> ดาวน์โหลดเร็ว
                            </button>
                            <button class="download-btn-secondary" onclick="downloadVideoFallback('audio', null, 'highestaudio')" title="ดาวน์โหลดผ่านเซิร์ฟเวอร์">
                                <i class="fas fa-server"></i>
                            </button>
                        </div>
                    </div>
                `;
            }

            // เพิ่ม CSS สำหรับปุ่มใหม่
            if (!document.getElementById('download-buttons-style')) {
                const style = document.createElement('style');
                style.id = 'download-buttons-style';
                style.textContent = `
                    .download-buttons {
                        display: flex;
                        gap: 8px;
                        margin-top: 10px;
                        justify-content: center;
                        align-items: center;
                    }
                    .download-btn-primary {
                        flex: 1;
                        padding: 8px 12px;
                        background: linear-gradient(45deg, #667eea, #764ba2);
                        color: white;
                        border: none;
                        border-radius: 6px;
                        font-size: 0.9rem;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .download-btn-primary:hover {
                        transform: translateY(-1px);
                        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
                    }
                    .download-btn-secondary {
                        padding: 8px 10px;
                        background: #6c757d;
                        color: white;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        min-width: 36px;
                    }
                    .download-btn-secondary:hover {
                        background: #5a6268;
                        transform: translateY(-1px);
                    }
                    .format-card {
                        cursor: default !important;
                    }
                    .format-card:hover {
                        transform: translateY(-3px) !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // ฟังก์ชันดาวน์โหลดวิดีโอแบบ direct link
        async function downloadVideo(format, itag, quality) {
            if (!currentVideoData) {
                showToast('กรุณาเลือกวิดีโอก่อนดาวน์โหลด', 'error');
                return;
            }

            const downloadBtn = event.target.closest('.format-card');
            const originalContent = downloadBtn.innerHTML;
            
            // แสดงสถานะกำลังดาวน์โหลด
            downloadBtn.innerHTML = `
                <i class="fas fa-spinner fa-spin"></i>
                <h4>กำลังเตรียม...</h4>
                <p>โปรดรอสักครู่</p>
            `;
            downloadBtn.style.pointerEvents = 'none';

            try {
                const videoUrl = document.getElementById('videoUrl').value;
                
                showToast('กำลังขอลิงก์ดาวน์โหลด...', 'info');
                
                // แสดง progress
                downloadBtn.innerHTML = `
                    <i class="fas fa-link"></i>
                    <h4>กำลังสร้างลิงก์...</h4>
                    <p>โปรดรอสักครู่</p>
                `;
                
                // เรียก API เพื่อรับ download URL
                const response = await fetch('/api/download-url', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        url: videoUrl,
                        format: format,
                        quality: quality,
                        itag: itag
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'เกิดข้อผิดพลาดในการสร้างลิงก์ดาวน์โหลด');
                }

                const data = await response.json();
                
                if (!data.success || !data.downloadUrl) {
                    throw new Error('ไม่สามารถสร้างลิงก์ดาวน์โหลดได้');
                }

                // แสดงสถานะการเริ่มดาวน์โหลด
                downloadBtn.innerHTML = `
                    <i class="fas fa-download"></i>
                    <h4>เริ่มดาวน์โหลด...</h4>
                    <p>กำลังเปิดลิงก์</p>
                `;

                // สร้าง element สำหรับดาวน์โหลด
                const a = document.createElement('a');
                a.href = data.downloadUrl;
                a.download = data.filename || 'download';
                a.target = '_blank';
                a.style.display = 'none';
                
                // เพิ่มการจัดการกับ CORS
                a.setAttribute('crossorigin', 'anonymous');
                
                document.body.appendChild(a);
                
                // เริ่มดาวน์โหลด
                try {
                    a.click();
                } catch (clickError) {
                    // ถ้าไม่สามารถ click ได้ ให้เปิดใน tab ใหม่
                    window.open(data.downloadUrl, '_blank');
                }
                
                document.body.removeChild(a);

                // แสดงสถานะสำเร็จ
                downloadBtn.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <h4>ดาวน์โหลดเริ่มแล้ว!</h4>
                    <p>ตรวจสอบการดาวน์โหลด</p>
                `;
                
                showToast(`เริ่มดาวน์โหลด "${data.filename}" แล้ว!`, 'success');

                // แสดงข้อมูลเพิ่มเติม
                const infoToast = document.createElement('div');
                infoToast.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    background: #3498db;
                    color: white;
                    border-radius: 8px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    z-index: 1000;
                    max-width: 350px;
                    font-size: 0.9rem;
                `;
                infoToast.innerHTML = `
                    <strong>💡 หมายเหตุ:</strong><br>
                    หากดาวน์โหลดไม่เริ่มโดยอัตโนมัติ<br>
                    คลิกขวาที่ลิงก์และเลือก "Save As..."
                    <br><br>
                    <small>รูปแบบ: ${data.format.quality} (${data.format.container})</small>
                `;
                document.body.appendChild(infoToast);
                
                setTimeout(() => {
                    if (document.body.contains(infoToast)) {
                        document.body.removeChild(infoToast);
                    }
                }, 8000);

                setTimeout(() => {
                    downloadBtn.innerHTML = originalContent;
                    downloadBtn.style.pointerEvents = 'auto';
                }, 3000);

            } catch (error) {
                console.error('Download error:', error);
                
                downloadBtn.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <h4>ดาวน์โหลดล้มเหลว</h4>
                    <p>กรุณาลองใหม่</p>
                `;
                
                setTimeout(() => {
                    downloadBtn.innerHTML = originalContent;
                    downloadBtn.style.pointerEvents = 'auto';
                }, 3000);
                
                if (error.message.includes('429')) {
                    showToast('คำขอมากเกินไป กรุณารอสักครู่แล้วลองใหม่', 'error');
                } else if (error.message.includes('unavailable')) {
                    showToast('วิดีโอไม่สามารถดาวน์โหลดได้ อาจถูกจำกัดการเข้าถึง', 'error');
                } else {
                    showToast(error.message || 'เกิดข้อผิดพลาดในการดาวน์โหลด', 'error');
                }
            }
        }

        // ฟังก์ชันดาวน์โหลดแบบ fallback (ผ่านเซิร์ฟเวอร์)
        async function downloadVideoFallback(format, itag, quality) {
            if (!currentVideoData) {
                showToast('กรุณาเลือกวิดีโอก่อนดาวน์โหลด', 'error');
                return;
            }

            const downloadBtn = event.target.closest('.format-card');
            const originalContent = downloadBtn.innerHTML;
            
            downloadBtn.innerHTML = `
                <i class="fas fa-spinner fa-spin"></i>
                <h4>กำลังดาวน์โหลด...</h4>
                <p>ผ่านเซิร์ฟเวอร์</p>
            `;
            downloadBtn.style.pointerEvents = 'none';

            try {
                const videoUrl = document.getElementById('videoUrl').value;
                
                showToast('กำลังดาวน์โหลดผ่านเซิร์ฟเวอร์...', 'info');
                
                const response = await fetch('/api/download', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        url: videoUrl,
                        format: format,
                        quality: quality,
                        itag: itag
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'เกิดข้อผิดพลาดในการดาวน์โหลด');
                }

                const contentDisposition = response.headers.get('Content-Disposition');
                let filename = 'download';
                if (contentDisposition) {
                    const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                    if (filenameMatch) {
                        filename = decodeURIComponent(filenameMatch[1]);
                    }
                } else {
                    const title = currentVideoData.video.title.replace(/[^\w\s-]/gi, '').replace(/\s+/g, '_');
                    filename = format === 'audio' ? `${title}.mp3` : `${title}.mp4`;
                }

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                downloadBtn.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <h4>ดาวน์โหลดสำเร็จ!</h4>
                    <p>ไฟล์ถูกบันทึกแล้ว</p>
                `;
                
                showToast(`ดาวน์โหลด "${filename}" สำเร็จ!`, 'success');

                setTimeout(() => {
                    downloadBtn.innerHTML = originalContent;
                    downloadBtn.style.pointerEvents = 'auto';
                }, 3000);

            } catch (error) {
                console.error('Fallback download error:', error);
                
                downloadBtn.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <h4>ดาวน์โหลดล้มเหลว</h4>
                    <p>ลองใหม่อีกครั้ง</p>
                `;
                
                setTimeout(() => {
                    downloadBtn.innerHTML = originalContent;
                    downloadBtn.style.pointerEvents = 'auto';
                }, 3000);
                
                showToast('ดาวน์โหลดผ่านเซิร์ฟเวอร์ล้มเหลว', 'error');
            }
        }

        // ตรวจสอบสถานะเซิร์ฟเวอร์
        async function checkServerStatus() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                if (data.status === 'OK') {
                    console.log('✅ เซิร์ฟเวอร์ทำงานปกติ');
                    return true;
                }
            } catch (error) {
                console.error('❌ ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์:', error);
                showToast('ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้', 'error');
                return false;
            }
        }

        // เริ่มต้นแอพพลิเคชัน
        async function initializeApp() {
            console.log('🚀 เริ่มต้นแอพพลิเคชัน YouTube Downloader');
            
            // ตรวจสอบสถานะเซิร์ฟเวอร์
            const serverOk = await checkServerStatus();
            
            if (!serverOk) {
                // แสดงข้อความแจ้งเตือนถ้าเซิร์ฟเวอร์ไม่ทำงาน
                const warningDiv = document.createElement('div');
                warningDiv.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    background: #e74c3c;
                    color: white;
                    padding: 10px;
                    text-align: center;
                    z-index: 1001;
                    font-weight: bold;
                `;
                warningDiv.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    ไม่สามารถเชื่อมต่อกับเซิร์ฟเวอร์ได้ - กรุณาตรวจสอบว่าเซิร์ฟเวอร์ทำงานอยู่
                `;
                document.body.appendChild(warningDiv);
            }
            
            // ตั้งค่า event listeners
            setupEventListeners();
        }

        // ตั้งค่า event listeners
        function setupEventListeners() {
            // Event Listeners สำหรับ Enter key
            document.getElementById('videoUrl').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    processVideo();
                }
            });

            // เพิ่ม event listener สำหรับ paste - ค้นหาอัตโนมัติ
            document.getElementById('videoUrl').addEventListener('paste', function(e) {
                setTimeout(() => {
                    const url = this.value.trim();
                    if (url && isValidYouTubeUrl(url)) {
                        showToast('พบ URL ที่ถูกต้อง - กำลังดึงข้อมูลอัตโนมัติ...', 'info');
                        // เริ่มประมวลผลทันทีเมื่อวาง URL
                        setTimeout(() => {
                            processVideo();
                        }, 500);
                    }
                }, 100);
            });

            // เพิ่ม event listener สำหรับการพิมพ์ - ตรวจสอบ URL แบบ real-time
            document.getElementById('videoUrl').addEventListener('input', function(e) {
                const url = this.value.trim();
                
                // ถ้า URL ถูกต้องและมีความยาวเพียงพอ
                if (url.length > 20 && isValidYouTubeUrl(url)) {
                    // เพิ่มการหน่วงเวลาเล็กน้อยเพื่อไม่ให้เรียก API บ่อยเกินไป
                    clearTimeout(this.autoSearchTimeout);
                    this.autoSearchTimeout = setTimeout(() => {
                        if (this.value.trim() === url) { // ตรวจสอบว่า URL ยังคงเหมือนเดิม
                            showToast('URL ถูกต้อง - กำลังดึงข้อมูลอัตโนมัติ...', 'info');
                            processVideo();
                        }
                    }, 1000); // รอ 1 วินาทีหลังจากหยุดพิมพ์
                }
            });
        }

        // เรียกใช้เมื่อ DOM โหลดเสร็จ
        document.addEventListener('DOMContentLoaded', initializeApp);

        // ฟังก์ชันตรวจสอบ URL ที่ถูกต้อง
        function isValidYouTubeUrl(url) {
            const regex = /^(https?\:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/;
            return regex.test(url);
        }

        // เพิ่ม validation สำหรับ URL พร้อม feedback ที่ดีขึ้น
        document.getElementById('videoUrl').addEventListener('blur', function() {
            const url = this.value.trim();
            const errorDiv = document.getElementById('url-error');
            
            // ลบ error message เก่า
            if (errorDiv) {
                errorDiv.remove();
            }
            
            if (url && !isValidYouTubeUrl(url)) {
                this.style.borderColor = '#e74c3c';
                
                // เพิ่ม error message
                const error = document.createElement('div');
                error.id = 'url-error';
                error.style.cssText = 'color: #e74c3c; font-size: 0.9rem; margin-top: 8px; padding-left: 50px;';
                error.textContent = 'กรุณาใส่ URL ของ YouTube ที่ถูกต้อง (เช่น: https://www.youtube.com/watch?v=...)';
                this.parentNode.appendChild(error);
            } else {
                this.style.borderColor = '#e0e0e0';
            }
        });

        // เพิ่ม loading state สำหรับปุ่ม
        function setButtonLoading(button, isLoading, originalText = '') {
            if (isLoading) {
                button.disabled = true;
                button.innerHTML = `<i class="fas fa-spinner fa-spin"></i> กำลังประมวลผล...`;
            } else {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }

        // ฟังก์ชันแสดง toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'error' ? '#e74c3c' : type === 'success' ? '#27ae60' : '#3498db'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                max-width: 300px;
                font-size: 0.9rem;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 4000);
        }

        // ฟังก์ชันสำหรับ Modal
        function openModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.style.display = 'block';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal(modalType) {
            const modal = document.getElementById(modalType + 'Modal');
            if (modal) {
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // ปิด modal เมื่อคลิกนอกพื้นที่
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        }

        // โหลด Google AdSense
        function loadAdsense() {
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.log('AdSense not loaded yet');
            }
        }

        // เรียกใช้ AdSense หลังจาก DOM โหลดเสร็จ
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadAdsense, 1000);
        });

        // Service Worker Registration for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('🎯 Service Worker registered:', registration);
                    })
                    .catch(error => {
                        console.log('❌ Service Worker registration failed:', error);
                    });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('📱 PWA Install prompt triggered');
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or banner
            showInstallBanner();
        });

        function showInstallBanner() {
            const installBanner = document.createElement('div');
            installBanner.id = 'install-banner';
            installBanner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                padding: 12px 20px;
                text-align: center;
                z-index: 1002;
                box-shadow: 0 2px 10px rgba(0,0,0,0.2);
                transform: translateY(-100%);
                transition: transform 0.3s ease;
            `;
            installBanner.innerHTML = `
                <span>📱 ติดตั้งแอพ YouTube Downloader เพื่อใช้งานได้แม้ไม่มีอินเทอร์เน็ต</span>
                <button onclick="installPWA()" style="
                    margin-left: 15px;
                    padding: 6px 12px;
                    background: rgba(255,255,255,0.2);
                    border: 1px solid rgba(255,255,255,0.3);
                    color: white;
                    border-radius: 4px;
                    cursor: pointer;
                ">ติดตั้ง</button>
                <button onclick="closeInstallBanner()" style="
                    margin-left: 8px;
                    padding: 6px 10px;
                    background: transparent;
                    border: none;
                    color: white;
                    cursor: pointer;
                    font-size: 16px;
                ">&times;</button>
            `;
            
            document.body.appendChild(installBanner);
            
            setTimeout(() => {
                installBanner.style.transform = 'translateY(0)';
            }, 500);
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('🎉 PWA installed');
                        showToast('🎉 แอพถูกติดตั้งแล้ว!', 'success');
                    }
                    deferredPrompt = null;
                    closeInstallBanner();
                });
            }
        }

        function closeInstallBanner() {
            const banner = document.getElementById('install-banner');
            if (banner) {
                banner.style.transform = 'translateY(-100%)';
                setTimeout(() => {
                    if (banner.parentNode) {
                        banner.parentNode.removeChild(banner);
                    }
                }, 300);
            }
        }
    </script>

    <!-- Google AdSense Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXX"
         crossorigin="anonymous"></script>
    
    <!-- Google Analytics (ถ้าต้องการ) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>

    <!-- Cookie Consent Notice -->
    <div id="cookieNotice" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; background: #2c3e50; color: white; padding: 15px; text-align: center; z-index: 1001;">
        <p>เว็บไซต์นี้ใช้คุกกี้เพื่อปรับปรุงประสบการณ์การใช้งานและแสดงโฆษณา 
        <a href="#privacy-policy" onclick="showPrivacyPolicy()" style="color: #3498db;">ดูนโยบายความเป็นส่วนตัว</a></p>
        <button onclick="acceptCookies()" style="background: #3498db; color: white; border: none; padding: 8px 16px; border-radius: 4px; margin-left: 10px; cursor: pointer;">ยอมรับ</button>
    </div>

    <script>
        // Cookie Consent
        function showCookieNotice() {
            if (!localStorage.getItem('cookieAccepted')) {
                document.getElementById('cookieNotice').style.display = 'block';
            }
        }

        function acceptCookies() {
            localStorage.setItem('cookieAccepted', 'true');
            document.getElementById('cookieNotice').style.display = 'none';
        }

        // แสดง Cookie Notice เมื่อโหลดหน้า
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(showCookieNotice, 2000); // แสดงหลังจาก 2 วินาที
        });
    </script>
</body>
</html>